{% extends "base.html" %}

{% block title %}Accueil - Dev Learning Hub{% endblock %}

{% block content %}
<div class="hero-section">
    <div class="hero-content">
        <h1 class="hero-title">
            <span class="title-glitch" data-text="Dev Learning Hub">Dev Learning Hub</span>
        </h1>
        <p class="hero-subtitle">
            MaÃ®trisez la programmation C dans l'univers Matrix - Plateforme d'apprentissage avancÃ©e
        </p>
        <div class="hero-stats">
            <div class="stat-item">
                <span class="stat-number dynamic-stat" data-base="125" data-variation="25">125</span>
                <span class="stat-label">Questions C</span>
            </div>
            <div class="stat-item">
                <span class="stat-number dynamic-stat" data-base="1200" data-variation="300">1,200</span>
                <span class="stat-label">Utilisateurs</span>
            </div>
            <div class="stat-item">
                <span class="stat-number dynamic-stat" data-base="80" data-variation="15">80+</span>
                <span class="stat-label">Commandes</span>
            </div>
            <div class="stat-item">
                <span class="stat-number dynamic-stat" data-base="8500" data-variation="1500">8,500</span>
                <span class="stat-label">Codes exÃ©cutÃ©s</span>
            </div>
        </div>
    </div>
</div>

<div class="features-section">
    <div class="container">
        <h2 class="section-title">
            <span class="section-icon">ðŸš€</span>
            FonctionnalitÃ©s
        </h2>
        
        <div class="features-grid">
            <div class="feature-card">
                <div class="feature-icon">ðŸ§ </div>
                <h3>Quiz Programmation C</h3>
                <p>100 questions interactives couvrant tous les aspects du langage C</p>
            </div>
            
            <div class="feature-card">
                <div class="feature-icon">ðŸ“Š</div>
                <h3>SystÃ¨me de Progression</h3>
                <p>Niveaux XP, badges et suivi dÃ©taillÃ© de votre apprentissage</p>
            </div>
            
            <div class="feature-card">
                <div class="feature-icon">ðŸ’»</div>
                <h3>Console Interactive</h3>
                <p>Terminal Matrix avec 80+ commandes Unix pour une expÃ©rience immersive</p>
            </div>
            
            <div class="feature-card">
                <div class="feature-icon">ðŸ”®</div>
                <h3>DLH Tutor</h3>
                <p>ExÃ©cuteur de code multi-langages (Python, JavaScript, C) intÃ©grÃ©</p>
            </div>
        </div>
    </div>
</div>

<div class="cta-section">
    <div class="container">
        <div class="cta-content">
            <h2 class="cta-title">PrÃªt Ã  maÃ®triser le langage C ?</h2>
            <p class="cta-subtitle">Rejoignez la Matrix et dÃ©veloppez vos compÃ©tences en programmation C</p>
            <div class="cta-buttons">
                {% if not session.user_id %}
                    <a href="{{ url_for('register') }}" class="btn btn-primary">
                        <span class="btn-icon">ðŸš€</span>
                        S'inscrire maintenant
                    </a>
                    <a href="{{ url_for('login') }}" class="btn btn-secondary">
                        <span class="btn-icon">ðŸ”‘</span>
                        Se connecter
                    </a>
                {% else %}
                    <a href="{{ url_for('dashboard') }}" class="btn btn-primary">
                        <span class="btn-icon">ðŸ“Š</span>
                        AccÃ©der au Dashboard
                    </a>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<div class="easter-egg-section">
    <div class="container">
        <div class="easter-egg-content">
            <h3>ðŸŽ® Console Commands</h3>
            <p>Ouvrez la console dÃ©veloppeur (F12) et essayez :</p>
            <div class="commands-list">
                <code class="command-item">konami()</code>
                <code class="command-item">matrix()</code>
                <code class="command-item">glitch()</code>
                <code class="command-item">hack()</code>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Animation d'entrÃ©e pour les cartes
document.addEventListener('DOMContentLoaded', function() {
    const cards = document.querySelectorAll('.feature-card');
    cards.forEach((card, index) => {
        card.style.animationDelay = `${index * 0.2}s`;
        card.classList.add('fade-in-up');
    });
    
    // Initialisation des statistiques dynamiques
    initDynamicStats();
});

function initDynamicStats() {
    const dynamicStats = document.querySelectorAll('.dynamic-stat');
    
    // Animation initiale des nombres
    dynamicStats.forEach((stat, index) => {
        const baseValue = parseInt(stat.dataset.base);
        const displayText = stat.textContent;
        
        // Animation d'entrÃ©e avec dÃ©lai
        setTimeout(() => {
            if (displayText.includes('+')) {
                animateNumberWithSuffix(stat, baseValue, '+');
            } else if (displayText.includes(',')) {
                animateFormattedNumber(stat, baseValue);
            } else {
                animateNumber(stat, baseValue);
            }
        }, index * 200);
    });
    
    // Mise Ã  jour pÃ©riodique des statistiques
    setInterval(updateRandomStats, 5000); // Toutes les 5 secondes
    
    // Mise Ã  jour plus frÃ©quente pour simuler l'activitÃ© en temps rÃ©el
    setInterval(updateRealtimeStats, 2000); // Toutes les 2 secondes pour certaines stats
}

function updateRandomStats() {
    const dynamicStats = document.querySelectorAll('.dynamic-stat');
    
    // SÃ©lectionner 1-2 statistiques Ã  mettre Ã  jour
    const statsToUpdate = Math.floor(Math.random() * 2) + 1;
    const indices = [];
    
    while (indices.length < statsToUpdate) {
        const randomIndex = Math.floor(Math.random() * dynamicStats.length);
        if (!indices.includes(randomIndex)) {
            indices.push(randomIndex);
        }
    }
    
    indices.forEach(index => {
        const stat = dynamicStats[index];
        updateSingleStat(stat);
    });
}

function updateRealtimeStats() {
    const dynamicStats = document.querySelectorAll('.dynamic-stat');
    
    // Mettre Ã  jour spÃ©cifiquement les "Codes exÃ©cutÃ©s" (index 3) plus frÃ©quemment
    const codesExecutedStat = dynamicStats[3];
    if (codesExecutedStat && Math.random() < 0.3) { // 30% de chance
        updateSingleStat(codesExecutedStat, true);
    }
    
    // Mettre Ã  jour les utilisateurs (index 1) occasionnellement
    const usersStat = dynamicStats[1];
    if (usersStat && Math.random() < 0.1) { // 10% de chance
        updateSingleStat(usersStat);
    }
}

function updateSingleStat(stat, isRealtime = false) {
    const baseValue = parseInt(stat.dataset.base);
    const variation = parseInt(stat.dataset.variation);
    const currentText = stat.textContent;
    
    // Calculer nouvelle valeur avec variation alÃ©atoire
    let variationRange = isRealtime ? variation * 0.3 : variation; // Variation plus petite en temps rÃ©el
    const randomVariation = Math.floor(Math.random() * variationRange * 2) - variationRange;
    let newValue = baseValue + randomVariation;
    
    // S'assurer que la valeur reste positive et rÃ©aliste
    newValue = Math.max(newValue, Math.floor(baseValue * 0.8));
    
    // Mettre Ã  jour selon le format
    stat.classList.add('stat-updating');
    
    if (currentText.includes('+')) {
        animateNumberWithSuffix(stat, newValue, '+');
    } else if (currentText.includes(',')) {
        animateFormattedNumber(stat, newValue);
    } else {
        animateNumber(stat, newValue);
    }
    
    // Effet visuel de mise Ã  jour
    setTimeout(() => {
        stat.classList.remove('stat-updating');
    }, 800);
}

function animateNumber(element, target) {
    let current = 0;
    const increment = target / 30;
    const timer = setInterval(() => {
        current += increment;
        if (current >= target) {
            current = target;
            clearInterval(timer);
        }
        element.textContent = Math.floor(current);
    }, 25);
}

function animateNumberWithSuffix(element, target, suffix) {
    let current = 0;
    const increment = target / 30;
    const timer = setInterval(() => {
        current += increment;
        if (current >= target) {
            current = target;
            clearInterval(timer);
        }
        element.textContent = Math.floor(current) + suffix;
    }, 25);
}

function animateFormattedNumber(element, target) {
    let current = 0;
    const increment = target / 30;
    const timer = setInterval(() => {
        current += increment;
        if (current >= target) {
            current = target;
            clearInterval(timer);
        }
        const formatted = Math.floor(current).toLocaleString('fr-FR');
        element.textContent = formatted;
    }, 25);
}

// Effet Matrix sur les statistiques
document.addEventListener('DOMContentLoaded', function() {
    const statItems = document.querySelectorAll('.stat-item');
    
    statItems.forEach(item => {
        item.addEventListener('mouseenter', function() {
            const statNumber = this.querySelector('.stat-number');
            statNumber.style.textShadow = '0 0 10px var(--primary-green)';
            statNumber.style.transform = 'scale(1.1)';
        });
        
        item.addEventListener('mouseleave', function() {
            const statNumber = this.querySelector('.stat-number');
            statNumber.style.textShadow = '';
            statNumber.style.transform = 'scale(1)';
        });
    });
});

// Simulation d'activitÃ© temps rÃ©el basÃ©e sur l'heure
function getActivityMultiplier() {
    const hour = new Date().getHours();
    // Plus d'activitÃ© pendant les heures de travail et d'Ã©tude
    if (hour >= 9 && hour <= 17) return 1.5; // JournÃ©e
    if (hour >= 19 && hour <= 22) return 1.3; // SoirÃ©e
    return 0.8; // Nuit/Matin
}

// Ajouter des Ã©vÃ©nements simulÃ©s
setInterval(() => {
    const activityLevel = getActivityMultiplier();
    if (Math.random() < 0.1 * activityLevel) { // Simulation d'une nouvelle exÃ©cution de code
        const codesExecutedStat = document.querySelector('.dynamic-stat[data-base="8500"]');
        if (codesExecutedStat) {
            const currentBase = parseInt(codesExecutedStat.dataset.base);
            codesExecutedStat.dataset.base = currentBase + Math.floor(Math.random() * 3) + 1;
        }
    }
}, 3000);
</script>
{% endblock %}
