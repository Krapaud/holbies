{% extends "base.html" %}

{% block title %}RÃ©sultats Quiz {{ results.category }} - Dev Learning Hub{% endblock %}

{% block content %}
<div class="quiz-results-container">
    <div class="results-header">
        <h1 class="results-title">
            <span class="title-icon">ğŸ¯</span>
            RÃ©sultats du Quiz
        </h1>
        <p class="results-subtitle">{{ results.category }}</p>
    </div>
    
    <div class="score-card">
        <div class="score-circle">
            <div class="score-number">{{ results.score }}/{{ results.total }}</div>
            <div class="score-percentage">{{ results.percentage }}%</div>
        </div>
        
        <div class="score-details">
            <h3 class="score-title">
                {% if results.percentage >= 80 %}
                    ğŸ† Excellent !
                {% elif results.percentage >= 60 %}
                    ğŸ‘ Bien jouÃ© !
                {% elif results.percentage >= 40 %}
                    ğŸ“š Peut mieux faire
                {% else %}
                    ğŸ’ª Continuez vos efforts !
                {% endif %}
            </h3>
            
            <div class="score-stats">
                <div class="stat-item">
                    <span class="stat-label">Bonnes rÃ©ponses</span>
                    <span class="stat-value">{{ results.score }}</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Total questions</span>
                    <span class="stat-value">{{ results.total }}</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Pourcentage</span>
                    <span class="stat-value">{{ results.percentage }}%</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Progression Display -->
    {% if results.progression %}
    <div class="progression-display">
        <h3 class="progression-title">
            <span class="progression-icon">ğŸ“ˆ</span>
            Progression
        </h3>
        
        {% if results.progression.level_up %}
        <div class="level-up-notification">
            ğŸ‰ NIVEAU SUPÃ‰RIEUR ! Vous Ãªtes maintenant niveau {{ results.progression.new_level }} ! ğŸ‰
        </div>
        {% endif %}
        
        <div class="xp-gained">
            +{{ results.progression.xp_gained }} XP gagnÃ©s !
        </div>
        
        <div class="progression-stats">
            <div class="stat-group">
                <span class="stat-label">XP Total</span>
                <span class="stat-value">{{ results.progression.total_xp }}</span>
            </div>
            <div class="stat-group">
                <span class="stat-label">Niveau Actuel</span>
                <span class="stat-value">{{ results.progression.new_level }}</span>
            </div>
        </div>
        
        {% if results.achievements %}
        <div class="new-achievements">
            <h4 style="color: var(--primary-green); margin-bottom: var(--spacing-md); grid-column: 1 / -1;">
                ğŸ† Nouveaux Achievements !
            </h4>
            {% for achievement in results.achievements %}
            <div class="new-achievement">
                <div class="new-achievement-icon">ğŸ…</div>
                <div class="new-achievement-name">{{ achievement[0] }}</div>
                <div class="new-achievement-desc">{{ achievement[1] }}</div>
            </div>
            {% endfor %}
        </div>
        {% endif %}
    </div>
    {% endif %}
    
    <div class="performance-badge">
        {% if results.percentage >= 90 %}
            <div class="badge expert">
                <span class="badge-icon">ğŸŒŸ</span>
                <span class="badge-text">Expert C</span>
            </div>
        {% elif results.percentage >= 80 %}
            <div class="badge advanced">
                <span class="badge-icon">ğŸ”¥</span>
                <span class="badge-text">Niveau AvancÃ©</span>
            </div>
        {% elif results.percentage >= 60 %}
            <div class="badge intermediate">
                <span class="badge-icon">ğŸ“ˆ</span>
                <span class="badge-text">Niveau IntermÃ©diaire</span>
            </div>
        {% elif results.percentage >= 40 %}
            <div class="badge beginner">
                <span class="badge-icon">ğŸŒ±</span>
                <span class="badge-text">DÃ©butant</span>
            </div>
        {% else %}
            <div class="badge novice">
                <span class="badge-icon">ğŸ“š</span>
                <span class="badge-text">Ã€ approfondir</span>
            </div>
        {% endif %}
    </div>
    
    <div class="answers-review">
        <h3 class="review-title">
            <span class="review-icon">ğŸ“</span>
            RÃ©vision des rÃ©ponses
        </h3>
        
        {% for answer_data in results.answers %}
        <div class="answer-card {% if answer_data.is_correct %}correct{% else %}incorrect{% endif %}">
            <div class="answer-header">
                <span class="question-number">Q{{ loop.index }}</span>
                <span class="answer-status">
                    {% if answer_data.is_correct %}
                        <span class="status-icon correct">âœ…</span>
                        <span class="status-text">Bonne rÃ©ponse</span>
                    {% else %}
                        <span class="status-icon incorrect">âŒ</span>
                        <span class="status-text">Ã€ revoir</span>
                    {% endif %}
                </span>
            </div>
            
            <div class="answer-content">
                <div class="question-section">
                    <h4 class="section-title">Question :</h4>
                    <p class="question-text">{{ answer_data.question }}</p>
                </div>
                
                <div class="user-answer-section">
                    <h4 class="section-title">Votre rÃ©ponse :</h4>
                    <div class="user-answer">{{ answer_data.user_answer }}</div>
                </div>
                
                <div class="correct-answer-section">
                    <h4 class="section-title">RÃ©ponse attendue :</h4>
                    <div class="correct-answer">{{ answer_data.correct_answer }}</div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    
    <div class="results-actions">
        <a href="/quiz" class="btn btn-primary">
            <span class="btn-icon">ğŸ¯</span>
            Faire un autre Quiz
        </a>
        
        <a href="/quiz/category/{{ results.category }}" class="btn btn-secondary">
            <span class="btn-icon">ğŸ”„</span>
            Refaire ce Quiz
        </a>
        
        <a href="/dashboard" class="btn btn-secondary">
            <span class="btn-icon">ğŸ“Š</span>
            Voir mes Statistiques
        </a>
    </div>
    
    <div class="recommendations">
        <h3 class="recommendations-title">
            <span class="recommendations-icon">ğŸ’¡</span>
            Recommandations
        </h3>
        
        <div class="recommendations-content">
            {% if results.percentage >= 80 %}
                <div class="recommendation">
                    <span class="rec-icon">ğŸš€</span>
                    <p>Excellent niveau ! Essayez les catÃ©gories plus avancÃ©es ou aidez d'autres dÃ©veloppeurs.</p>
                </div>
            {% elif results.percentage >= 60 %}
                <div class="recommendation">
                    <span class="rec-icon">ğŸ“–</span>
                    <p>Bon niveau ! RÃ©visez les questions ratÃ©es et pratiquez avec des exercices de code.</p>
                </div>
            {% else %}
                <div class="recommendation">
                    <span class="rec-icon">ğŸ“š</span>
                    <p>Continuez l'apprentissage ! Consultez la documentation C et pratiquez les bases.</p>
                </div>
                <div class="recommendation">
                    <span class="rec-icon">ğŸ’»</span>
                    <p>Ã‰crivez du code C rÃ©guliÃ¨rement pour consolider vos connaissances.</p>
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="/static/js/quiz_results.js"></script>
{% endblock %}
